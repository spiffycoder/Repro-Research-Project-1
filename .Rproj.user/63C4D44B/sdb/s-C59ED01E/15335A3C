{
    "contents" : "---\ntitle: \"Reproducible Research: Peer Assessment 1\"\nauthor: \"wp\"\ndate: \"September 20, 2015\"\noutput: html_document\n---\n\nLoading and preprocessing the data:\n\n```{r}\n# Load required libraries:\nlibrary(ggplot2)\nlibrary(xtable)\n```\n\n```{r}\n# Load the activity data:\ndf.i <- read.csv(\"activity.csv\")\n```\n\n```{r}\n\n\n# Check the data:\nh.noproc <- head(df.i, 5)\nh.noproc <- xtable(h.noproc, caption=\"First 5 rows: non-processed\", label=\"Head Xtable\", digits=1)\nprint(h.noproc, include.rownames = TRUE, caption.placement=\"top\")\n\n# preliminary processing of the data:\n# ignore missing values:\ndf <- na.omit(df.i)\nh.proc <- head(df, 5)\nh.proc <- xtable(h.proc, caption=\"First 5 rows: processed\", label=\"HeadP Xtable\", digits=1)\nprint(h.proc, include.rownames = TRUE, caption.placement=\"top\")\n\n## What is mean total number of steps taken per day?\ndf.steps <- aggregate(steps ~ date, df, sum)\n\n# Histogram of the total number of steps taken each day\nhist(df.steps$steps, col=\"lightgreen\", main = \"Histogram of Total Steps Taken Each Day\", \n     xlab=\"Total Number of Steps in a Day\")\n\n# Calculate mean and median steps per day:\nmean(df.steps$steps)\nmedian(df.steps$steps)\n\n##New Bins set\n#qplot(steps, data=df.steps, binwidth = \"1\", xlab = \"Total number of steps taken each day\", \n#      main = \"Steps with binwidth set at 1\", na.rm=TRUE) + \n#      geom_histogram(colour=\"darkgreen\", aes(fill = ..count..)) \n\n## What is the average daily activity pattern?\nlibrary(ggplot2)\ndf.averages <- aggregate(x=list(steps=df$steps), by=list(interval=df$interval), FUN=mean)\nggplot(data=df.averages, aes(x=interval, y=steps)) + geom_line() + \n  xlab(\"Intervals set at 5 minutes\") + ylab(\"Average of steps taken\")\n\n# Which interval has most steps:\ndf.averages[which.max(df.averages$steps),]\n\n## Imputing missing values\n\n# Find how much we're missing:\ndf.missing <- is.na(df$steps)\nnum.missing <- sum(df.missing)\ntable(df.missing)\ntable (num.missing)\n\n# replace the missing values with the mean value of the 5-minute intervals\nnafiller <- function(steps, interval){\n  filler <- NA\n  if (!is.na(steps))\n    filler <- c(steps)\n  else\n    filler <- (df.averages[df.averages$interval==interval, \"steps\"])\n  return(filler)\n}\nmyfill.df <- df\nmyfill.df$steps <- mapply(nafiller, myfill.df$steps, myfill.df$interval)\n\nhead(myfill.df)\n\n# New historgram:\nmyts <- tapply(myfill.df$steps, myfill.df$date)\nqplot(myts, binwidth=5, xlab=\"Total Number of Steps per Day\",\n      main=\"Total Number of Steps per Day After Imput\")\n\nlibrary(psych)\n\ndescribe(myts)\nmean(myts)\nmedian(myts)\nsummary(myts)\n\n# Compare differences in activity patterns between weekdays and weekends\nweek.identify <- function(date){\n day <- weekdays(date)\n if (day %in% c(\"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\"))\n   return(\"Weekday\")\n else if (day %in% c(\"Saturday\", \"Sunday\"))\n   return(\"Weekend\")\n else\n   stop(\"Invalid Date\")\n}  \nmyfill.df$date <- as.Date(myfill.df$date)\nmyfill.df$day <- sapply(myfill.df$date, FUN=week.identify)\n\nhead(myfill.df$day)\navg <- aggregate(steps ~ interval + day, data=myfill.df, mean)\nggplot(avg, aes(interval, steps))+geom_line()+ facet_grid(day ~ .) + xlab(\"Intervals at 5 minutes\") + ylab(\"# of Steps\")\n\n# Yes, there is a difference.\n```\n\n",
    "created" : 1442783799846.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "707118928",
    "id" : "15335A3C",
    "lastKnownWriteTime" : 1442784443,
    "path" : "~/Coursera/05 Reproducible Research/Peer assessment 1/Git/PA1_template.Rmd",
    "project_path" : "PA1_template.Rmd",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "type" : "r_markdown"
}